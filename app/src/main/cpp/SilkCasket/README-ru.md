# SilkCasket

* Формат архивов, ориентированный на гибкость

## Преимущества

* Возможность использования различных алгоритмов сжатия для разных элементов
* Официальная поддержка шифрования
* Восстановление данных
* Интеграция алгоритмов LZ4, LZW, LZMA2 Fast, Lizard
* Высокая совместимость
* Легковесность

## Совместимость


| Платформа | x86_64 | x86 | arm64 | arm32 |
| --------- | ------ | --- | ----- | ----- |
| Android   | ✔     | ✔  | ✔    | ✔    |
| Linux     | ✔     | ✔  | ✔    | ✔    |
| Windows   | ?      | ?  | ?    | ?    |
| Mac       | ?      | ?  | ?    | ?    |
| iOS       | ?      | ×  | ?    | ×    |

* Примечание: Windows, Mac, iOS не были протестированы, iOS не поддерживает архитектуры x86_64 и x86

## API

### Связанное со сжатием

- **Сжатие указанного каталога**

  - Описание: Позволяет пользователю сжать весь каталог.
  - Параметры:
    - `suffix`: булево значение, определяющее, добавлять ли суффикс, указывающий режим сжатия, к имени выходного файла.
    - `targetPath`: путь к каталогу, который нужно сжать.
    - `outPath`: путь к выходному файлу архива.
    - `mode`: выбор используемого алгоритма сжатия.
    - `entryEncryption` (опционально): булево значение, по умолчанию `false`, указывает, будет ли применено шифрование к элементам.
    - `Key` (опционально): строка, если `entryEncryption` установлено в `true`, то необходимо предоставить непустую строку в качестве ключа.

- **Сжатие одного файла**

  - Описание: Применяется только к одному файлу.
  - Параметры такие же, как выше.

- **Сжатие нескольких файлов**

  - Описание: Позволяет пользователям сжимать несколько файлов одновременно, при этом можно указать относительный путь каждого файла внутри архива.
  - Параметры:
    - `targetPaths`: отображение путей файлов, где ключ — это исходный путь файла, а значение — целевой путь (внутри архива).
    - Остальные параметры такие же, как выше.

- **Интерфейсы сжатия с дополнительными функциями**

  - Описание: Может предлагать дополнительные функции или опции, в зависимости от реализации.
  - Параметры такие же, как выше.

### Связанное с распаковкой

- **Распаковка всех элементов в указанный путь**

  - Описание: Извлекает все содержимое из данного архива в указанный каталог.
  - Параметры:
    - `filePath`: путь к архиву, который нужно распаковать.
    - `outPath`: путь к выходному каталогу.
    - `key`: если при сжатии использовалось шифрование, здесь необходимо предоставить тот же ключ для распаковки.

- **Распаковка определенного элемента в указанный путь**

  - Описание: Извлекает определенный элемент (файл или каталог) из данного архива в указанный каталог.
  - Параметры:
    - `Entry`: имя элемента, который нужно распаковать.
    - Остальные параметры такие же, как выше.

- **Распаковка определенного каталога в указанный путь**

  - Описание: Извлекает определенный каталог из данного архива в указанный каталог.
  - Параметры такие же, как «Распаковка определенного элемента в указанный путь».

```cpp
/**
 * @brief Сжатие указанного каталога.
 *
 * Эта функция позволяет пользователю сжать весь каталог, с возможностью выбора шифрования и алгоритма сжатия.
 *
 * @param suffix Добавлять ли суффикс, указывающий режим сжатия, к имени выходного файла.
 * @param targetPath Путь к каталогу, который нужно сжать.
 * @param outPath Путь к выходному файлу архива.
 * @param mode Выбор алгоритма сжатия, используя перечисление SilkCasket::Compress::Mode::MODE.
 * @param entryEncryption Нужно ли шифровать элементы, по умолчанию false.
 * @param Key Ключ для шифрования, если entryEncryption установлено в true, то необходимо предоставить непустую строку в качестве ключа.
 */
void SilkCasket_compressDirectory(bool suffix,
                                  const std::filesystem::path &targetPath,
                                  std::filesystem::path outPath,
                                  SilkCasket::Compress::Mode::MODE mode,
                                  bool entryEncryption = false,
                                  const std::string &Key = "");

/**
 * @brief Сжатие одного файла.
 *
 * Аналогично сжатию каталога, но применяется только к одному файлу.
 *
 * @param suffix См. выше.
 * @param targetPath Путь к файлу, который нужно сжать.
 * @param outPath Путь к выходному файлу архива.
 * @param mode Выбор алгоритма сжатия.
 * @param entryEncryption Нужно ли шифровать элементы.
 * @param Key Ключ для шифрования.
 */
void SilkCasket_compress_A_File(bool suffix,
                                const std::filesystem::path &targetPath,
                                std::filesystem::path outPath,
                                SilkCasket::Compress::Mode::MODE mode,
                                bool entryEncryption = false,
                                const std::string &Key = "");

/**
 * @brief Сжатие нескольких файлов.
 *
 * Позволяет пользователю сжимать несколько файлов одновременно, при этом можно указать относительный путь каждого файла внутри архива.
 *
 * @param suffix См. выше.
 * @param targetPaths Отображение путей файлов, где ключ — это исходный путь файла, а значение — целевой путь (внутри архива).
 * @param outPath Путь к выходному файлу архива.
 * @param mode Выбор алгоритма сжатия.
 * @param entryEncryption Нужно ли шифровать элементы.
 * @param Key Ключ для шифрования.
 */
void SilkCasket_compress_Files(
    bool suffix,
    const std::map<std::filesystem::path, std::filesystem::path>& targetPaths,
    std::filesystem::path outPath,
    SilkCasket::Compress::Mode::MODE mode,
    bool entryEncryption = false,
    const std::string &Key = ""
);

/**
 * @brief Интерфейсы сжатия с дополнительными функциями.
 *
 * Эта функция может предлагать дополнительные функции или опции, в зависимости от реализации.
 *
 * Параметры такие же, как выше.
 */
void SilkCasket_compress(
    bool suffix,
    const std::map<std::filesystem::path, std::filesystem::path>& targetPaths,
    std::filesystem::path outPath,
    SilkCasket::Compress::Mode::MODE mode,
    bool entryEncryption = false,
    const std::string &Key = ""
);

/**
 * @brief Распаковка всех элементов в указанный путь.
 *
 * Извлекает все содержимое из данного архива в указанный каталог.
 *
 * @param filePath Путь к архиву, который нужно распаковать.
 * @param outPath Путь к выходному каталогу.
 * @param key Если при сжатии использовалось шифрование, здесь необходимо предоставить тот же ключ для распаковки.
 */
void releaseAllEntry(const std::filesystem::path& filePath,
                     const std::filesystem::path& outPath,
                     std::string key);

/**
 * @brief Распаковка определенного элемента в указанный путь.
 *
 * Извлекает определенный элемент (файл или каталог) из данного архива в указанный каталог.
 *
 * @param filePath Путь к архиву, который нужно распаковать.
 * @param Entry Имя элемента, который нужно распаковать.
 * @param outPath Путь к выходному каталогу.
 * @param key Если при сжатии использовалось шифрование, здесь необходимо предоставить тот же ключ для распаковки.
 */
void releaseEntry(const std::filesystem::path& filePath,
                  const std::string& Entry,
                  const std::filesystem::path& outPath,
                  std::string key);

/**
 * @brief Распаковка определенного каталога в указанный путь.
 *
 * Извлекает определенный каталог из данного архива в указанный каталог.
 *
 * Параметры такие же, как выше.
 */
void releaseFolder(const std::filesystem::path& filePath,
                   std::string Entry,
                   const std::filesystem::path& outPath,
                   std::string key);
```
